#summary การประยุกต์ใช้เชลล์สคริปต์ 2
<table width=500>
<td>
[CourseSchedule2555_2 กลับไปหน้าหลัก]-->[<a href="https://code.google.com/p/system-programming-cs3402-at-crma/wiki/CourseSchedule2555_2#ตารางเรียน_๒๕๕๕/๒">ตารางเรียน</a>]-->Next: [shellScriptApp3 การประยุกต์ใช้เชลล์สคริปต์ ๓]
<wiki:toc max_depth="3" />
=คำสั่ง printf=
คำสั่ง printf ทำงานใกล้เคียงกับคำสั่ง printf() ในภาษา C ที่เราคุ้นเคย รูปแบบคำสั่งในเชลล์เป็นดังนี้
{{{
printf "format string" parameter1 parameter2 ...
}}}

||Escape Sequence ||หมายเหตุ||
||\\ ||Backslash character.||
||\a ||Alert (rings the bell or beep).||
||\b ||Backspace character.||
||\f ||Form feed character.||
||\n ||Newline character.||
||\r ||Carriage return.||
||\t ||Tab character.||
||\v ||Vertical tab character.||
||\ooo ||The single character with actual octal value ooo||

ตัวอย่างของตัวกำหนดค่าที่ใช้บ่อย

||กำหนดค่าตัวแปร|| หมายเหตุ||
||d|| เลขจำนวนเต็ม||
||c|| ตัวอักษร||
||s|| สตริง||
||%|| เครื่องหมาย % ||

{{{
$ printf "%s\n" hello
hello
}}}
อีกตัวอย่างของการใช้ printf
{{{
$ printf "%s %d\t%s" "Hi there" 15 people
Hi there 15 people
}}}

=คำสั่ง set และ unset =
คำสั่ง set ตั้งค่าของพารามิเตอร์ของเชลล์ สำหรับพารามิเตอร์ที่คั่นด้วย space
ตัวอย่างเช่น
{{{
set x y z
}}} 
จะกำหนดค่า ของ x ไปที่ $1, y ไปที่ $2 และ z ไปที่ $3
ผลของการรันคำสั่งต่อไป
{{{
set x y z
echo $2
}}}
จะได้ผลลัพธ์เท่ากับ
{{{
y
}}}

ถ้ารัน set โดยไม่มีพารามิเตอร์ จะพิมพ์ค่าของตัวแปรทั้งหมดเรียงตามลำดับอักษร เช่น
{{{
set |head
}}}
จะได้ผลลัพธ์คือ
{{{
BASH=/bin/bash
BASHOPTS=checkwinsize:cmdhist:expand_aliases:extglob:extquote:force_fignore:histappend:interactive_comments:login_shell:progcomp:promptvars:sourcepath
BASH_ALIASES=()
BASH_ARGC=()
BASH_ARGV=()
BASH_CMDS=()
BASH_COMPLETION=/etc/bash_completion
BASH_COMPLETION_COMPAT_DIR=/etc/bash_completion.d
BASH_COMPLETION_DIR=/etc/bash_completion.d
BASH_LINENO=()
}}}
ตัวอย่างการใช้งาน
{{{
#! /bin/bash
echo the date is $(date)
set $(date)
echo The month is $2
exit 0
}}}
จะได้ผลลัพธ์เป็น
{{{
the date is Thu Nov 13 23:16:33 SAT 1997
The month is Nov
}}}
เนื่องจากคำสั่ง date ให้ผลลัพธ์เป็น {{{Thu Nov 13 23:16:33 SAT 1997}}} ซึ่งเมื่อรันคำสั่ง {{{set $(date)}}} จะทำให้ $1=Thu, $2=Nov, ตามลำดับ ดังนั้นจึงได้ผลลัพธ์ดังตัวอย่างข้างต้น

=ปัญหา ๑=
  * ต้องการสร้างหน้าเว็บที่รับอินพุทจากผู้ใช้ เพื่อรันคำสั่งในเชลล์

==แนวทาง==
ในตัวอย่างนี้
===การรันคำสั่งเชลล์ผ่าน PHP===
PHP สามารถรันคำสั่งในเชลล์ได้ และยังสามารถแสดงผลลัพธ์ของการรัน จากตัวอย่างต่อไปนี้
{{{
<?php
$output = shell_exec('last');
echo "<pre>$output</pre>";
?>
}}}
===การรับอินพุทจากผู้ใช้ผ่านบราวเซอร์===
ในส่วนนี้เราต้องการให้ผู้ใช้สามารถป้อนคำสั่งที่จะรันผ่านฟอร์มของที่หน้าบราวเซอร์ ส่วนี้สามารถใช้สคริปต์ [http://www.w3schools.com/php/php_forms.asp PHP] ที่สนับสนุนการทำงานผ่านฟอร์ม และสามารถส่งคำสั่งจากผู้ใช้ไปยังเชลล์ได้ตามโปรแกรม 
{{{
<html>
<body>
<table widht=500><td>
<!-- written by pyavinci@gmail.com -->

<form action="shexec.php" method="post">
Command: <input type="text" name="cmd" />
Params: <input type="text" name="params" />
<input type="submit" />
</form>
<hr>
Shell command executed :
<?php echo $_POST["cmd"]; ?>
<?php echo $_POST["params"]; ?>
<hr>
<?php
$lcmd =  $_POST["cmd"]." ".$_POST["params"];
$output = shell_exec($lcmd);
echo "<pre>$output</pre>";
?>
</td></table>
</body>
</html>
}}}
===ปรับแต่งโปรแกรม===
{{{
<html>
<body>
<table width=500><td>
<!-- written by pyavinci@gmail.com -->

<table width=500 bgcolor=#33CC33><td>
<form action="shexec.php" method="post">
Command: <input type="text" name="cmd" />
Params: <input type="text" name="params" />
<input type="submit" />
</form>
</td></table>
<hr>
<table width=500><tr>
<td width=200> Shell command executed :</td>
<td bgcolor=#FF9900 widht=20></td>
<td bgcolor=#FFCC00>
<?php echo "  "; ?>
<?php echo $_POST["cmd"]; ?>
<?php echo $_POST["params"]; ?>
</td>
</tr></table>
<hr>
<table width=500 bgcolor=#CCFFCC><td>
<?php
$lcmd =  $_POST["cmd"]." ".$_POST["params"];
$output = shell_exec($lcmd);
echo "<pre>$output</pre>";
?>
</td></table>
</td></table>
</body>
</html>
}}}
เพิ่มการควบคุมสีของการแสดง สามารถตรวจสอบได้จากการรัน
[http://10.134.64.45/prachya/shell/intermediate/shexec.php shexec.php]

https://dl.dropbox.com/u/37142998/2012%20System%20Programming/Figures/shexec-screen.png

=ปัญหา ๒=

[CourseSchedule2555_2 กลับไปหน้าหลัก]-->[<a href="https://code.google.com/p/system-programming-cs3402-at-crma/wiki/CourseSchedule2555_2#ตารางเรียน_๒๕๕๕/๒">ตารางเรียน</a>]-->Next: [shellScriptApp3 การประยุกต์ใช้เชลล์สคริปต์ ๓]